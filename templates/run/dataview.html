{% include "run/index.html" %}
{% load static %}

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="{% static 'style2.css' %}">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>



{% block content %}



<div class="d-flex justify-content-left">
    <div class="border border-primary p-3 bg-light" style="width: 25%; margin: auto; margin-bottom: 20px; border-radius: 20px;">
        <h6 class="text-center mb-4" style="font-weight: bold;">Race Results</h6>
        <div class="row">
            <div class="col-6">
                <form method="post">
                    {% csrf_token %}
                    <div class=""form-group mb-2">
                        <p style="line-height: 1.5;">Select events to view graph</p>
                    </div>

                    <div class="form-group mb-2">
                        <label for="{{ form.location.id_for_label }}" style="font-weight: bold;">Select a Location:</label>
                        {{ form.location }}
                    </div>
                    <div class="form-group mb-2">
                        <label for="{{ form.year.id_for_label }}" style="font-weight: bold;">Select a Year:</label>
                        {{ form.year }}
                    </div>
                    <div class="form-group mb-2">
                        <label for="{{ form.month.id_for_label }}" style="font-weight: bold;">Select a Month:</label>
                        {{ form.month }}
                    </div>
                    <div class="form-group mb-2">
                        <label for="{{ form.event.id_for_label }}" style="font-weight: bold;">Select an Event:</label>
                        {{ form.event }}
                    </div>
                    <div class="form-group text-center my-5 d-flex justify-content-center">
                        <button type="submit" class="btn btn-primary">Create</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


<script>
    $(document).ready(function() {
        $("#id_location, #id_year, #id_month").change(function() {
            var location_id = $("#id_location").val();
            var year = $("#id_year").val();
            var month = $("#id_month").val();
            $.get("{% url 'get_events' %}", {location_id: location_id, year: year, month: month}, function(data) {
                var select = $("#id_event");
                select.empty();
                data.events.forEach(function(event) {
                    var option = $("<option>").val(event.id).text(event.number +  " " + new Date(event.Date).toLocaleDateString("en-GB", {
    day: "2-digit",
    month: "2-digit",
    year: "numeric"
}));
                    select.append(option);
                });
            });
        });
    });
</script>










{% endblock %}